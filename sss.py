import tkinter as tk
from tkinter import ttk, messagebox, filedialog
from PIL import Image, ImageDraw, ImageTk
import pandas as pd
import os
import re
import math


class TaskApp:
    def __init__(self, root):
        self.root = root
        self.root.title("–¢—Ä–µ–Ω–∞–∂–µ—Ä –ï–ì–≠ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ")
        self.root.geometry("650x550")

        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å—Ç–∏–ª—å
        self.setup_styles()

        # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–¥–∞—á–∞—Ö –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
        self.load_data()

        # –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        self.create_main_window()

    def setup_styles(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        style = ttk.Style()
        style.theme_use('clam')

        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞
        self.colors = {
            'bg': '#f0f8ff',
            'primary': '#4a6fa5',
            'secondary': '#6b9ac4',
            'success': '#90ee90',
            'warning': '#ffcccb',
            'text': '#2c3e50',
            'light': '#e8f4f8'
        }

    def load_data(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–¥–∞—á–∞—Ö –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞"""
        # –°–æ–∑–¥–∞–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –∏–∑ –ï–ì–≠
        tasks_data = [
            # –£—Ä–∞–≤–Ω–µ–Ω–∏—è (1-10)
            [1, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x + 5 = 13', '', False, '4'],
            [2, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 3(x - 4) = 15', '', False, '9'],
            [3, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: x¬≤ - 5x + 6 = 0', '', False, '2;3'],
            [4, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2x¬≤ + 3x - 2 = 0', '', False, '0.5;-2'],
            [5, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: ‚àö(x + 2) = 3', '', False, '7'],
            [6, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: |x - 3| = 7', '', False, '10;-4'],
            [7, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2À£ = 16', '', False, '4'],
            [8, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: log‚ÇÉ(x) = 4', '', False, '81'],
            [9, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: sin(x) = 1/2 –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ [0; 2œÄ]', '', False, 'œÄ/6;5œÄ/6'],
            [10, '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: cos(2x) = 1/2 –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ [0; œÄ]', '', False, 'œÄ/6;5œÄ/6'],

            # –ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ (11-20)
            [11, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: 3x - 7 > 5', '', False, 'x>4'],
            [12, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: 2x + 1 ‚â§ x - 3', '', False, 'x‚â§-4'],
            [13, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: x¬≤ - 9 < 0', '', False, '-3<x<3'],
            [14, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: (x-2)(x+4) ‚â• 0', '', False, 'x‚â§-4;x‚â•2'],
            [15, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: 2À£ > 8', '', False, 'x>3'],
            [16, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: log‚ÇÇ(x) < 4', '', False, '0<x<16'],
            [17, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: |x + 2| ‚â§ 5', '', False, '-7‚â§x‚â§3'],
            [18, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: ‚àö(x-1) > 2', '', False, 'x>5'],
            [19, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: (x-3)/(x+2) > 0', '', False, 'x<-2;x>3'],
            [20, '–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞', '–†–µ—à–∏—Ç–µ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: x¬≤ + 4x + 3 ‚â§ 0', '', False, '-3‚â§x‚â§-1'],

            # –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è (21-30)
            [21, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = 4x¬≥ - 2x¬≤ + x - 5', '', False, '12x¬≤-4x+1'],
            [22, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = sin(x) - cos(x)', '', False, 'cos(x)+sin(x)'],
            [23, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = eÀ£ + ln(x)', '', False, 'eÀ£+1/x'],
            [24, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = (x+3)‚Å¥', '', False, '4(x+3)¬≥'],
            [25, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = x¬∑sin(x)', '', False, 'sin(x)+x¬∑cos(x)'],
            [26, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = ‚àöx + 1/x', '', False, '1/(2‚àöx)-1/x¬≤'],
            [27, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = tg(x)', '', False, '1/cos¬≤(x)'],
            [28, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = ln(x¬≤)', '', False, '2/x'],
            [29, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = 2À£', '', False, '2À£¬∑ln2'],
            [30, '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è', '–ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏: f(x) = 3x‚Åµ - 4x¬≥ + 2x - 1', '', False, '15x‚Å¥-12x¬≤+2'],

            # –ì–µ–æ–º–µ—Ç—Ä–∏—è (31-45)
            [31, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–∞—Ç–µ—Ç—ã —Ä–∞–≤–Ω—ã 6 –∏ 8. –ù–∞–π–¥–∏—Ç–µ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—É', '', False, '10'],
            [32, '–ì–µ–æ–º–µ—Ç—Ä–∏—è',
             '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞ —Ä–∞–≤–Ω–∞ 25, –æ–¥–∏–Ω –∫–∞—Ç–µ—Ç —Ä–∞–≤–µ–Ω 7. –ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ—Ç', '', False,
             '24'],
            [33, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–∞—Ç–µ—Ç—ã —Ä–∞–≤–Ω—ã 5 –∏ 12. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', '', False, '30'],
            [34, '–ì–µ–æ–º–µ—Ç—Ä–∏—è',
             '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –≤—ã—Å–æ—Ç–∞ –∫ –≥–∏–ø–æ—Ç–µ–Ω—É–∑–µ —Ä–∞–≤–Ω–∞ 12, –ø—Ä–æ–µ–∫—Ü–∏—è –æ–¥–Ω–æ–≥–æ –∫–∞—Ç–µ—Ç–∞ —Ä–∞–≤–Ω–∞ 9. –ù–∞–π–¥–∏—Ç–µ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—É',
             '', False, '25'],
            [35, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π 6 –Ω–∞–π–¥–∏—Ç–µ –≤—ã—Å–æ—Ç—É', '', False, '3‚àö3'],
            [36, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π 8 –Ω–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', '', False, '16‚àö3'],
            [37, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞–≤–Ω–æ 10, –±–æ–∫–æ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ 13. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å',
             '', False, '60'],
            [38, '–ì–µ–æ–º–µ—Ç—Ä–∏—è',
             '–í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–π —Ç—Ä–∞–ø–µ—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è —Ä–∞–≤–Ω—ã 5 –∏ 11, –±–æ–∫–æ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ —Ä–∞–≤–Ω–∞ 5. –ù–∞–π–¥–∏—Ç–µ –≤—ã—Å–æ—Ç—É', '', False,
             '4'],
            [39, '–ì–µ–æ–º–µ—Ç—Ä–∏—è',
             '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π —Ç—Ä–∞–ø–µ—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è —Ä–∞–≤–Ω—ã 4 –∏ 10, –±–æ–ª—å—à–∞—è –±–æ–∫–æ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ —Ä–∞–≤–Ω–∞ 10. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', '',
             False, '70'],
            [40, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–∞–≤–Ω—ã 5 –∏ 8, –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª —Ä–∞–≤–µ–Ω 60¬∞. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', '',
             False, '20‚àö3'],
            [41, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ä–æ–º–±–µ —Å—Ç–æ—Ä–æ–Ω–∞ —Ä–∞–≤–Ω–∞ 13, –æ–¥–Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å —Ä–∞–≤–Ω–∞ 24. –ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–≥—É—é –¥–∏–∞–≥–æ–Ω–∞–ª—å', '', False,
             '10'],
            [42, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ä–æ–º–±–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —Ä–∞–≤–Ω—ã 12 –∏ 16. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å', '', False, '96'],
            [43, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫—Ä—É–≥–µ —Ä–∞–¥–∏—É—Å–æ–º 10 –Ω–∞–π–¥–∏—Ç–µ –¥–ª–∏–Ω—É –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ (œÄ ‚âà 3.14)', '', False, '62.8'],
            [44, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫—Ä—É–≥–µ —Ä–∞–¥–∏—É—Å–æ–º 6 –Ω–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å –∫—Ä—É–≥–∞ (œÄ ‚âà 3.14)', '', False, '113.04'],
            [45, '–ì–µ–æ–º–µ—Ç—Ä–∏—è', '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —É–≥–æ–ª –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ —Ä–∞–≤–µ–Ω 60¬∞, —Ä–∞–¥–∏—É—Å —Ä–∞–≤–µ–Ω 6. –ù–∞–π–¥–∏—Ç–µ –¥–ª–∏–Ω—É –¥—É–≥–∏ (œÄ ‚âà 3.14)',
             '', False, '6.28'],

            # –°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è (46-60)
            [46, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫—É–±–µ —Å —Ä–µ–±—Ä–æ–º 5 –Ω–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º', '', False, '125'],
            [47, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫—É–±–µ —Å —Ä–µ–±—Ä–æ–º 4 –Ω–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å –ø–æ–ª–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏', '', False, '96'],
            [48, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º –ø–∞—Ä–∞–ª–ª–µ–ª–µ–ø–∏–ø–µ–¥–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è 3, 4, 12. –ù–∞–π–¥–∏—Ç–µ –¥–ª–∏–Ω—É –¥–∏–∞–≥–æ–Ω–∞–ª–∏', '',
             False, '13'],
            [49, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º –ø–∞—Ä–∞–ª–ª–µ–ª–µ–ø–∏–ø–µ–¥–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è 2, 3, 6. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º', '', False, '36'],
            [50, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Ü–∏–ª–∏–Ω–¥—Ä–µ —Ä–∞–¥–∏—É—Å –æ—Å–Ω–æ–≤–∞–Ω–∏—è 4, –≤—ã—Å–æ—Ç–∞ 7. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º (œÄ ‚âà 3.14)', '', False,
             '351.68'],
            [51, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è',
             '–í —Ü–∏–ª–∏–Ω–¥—Ä–µ —Ä–∞–¥–∏—É—Å –æ—Å–Ω–æ–≤–∞–Ω–∏—è 5, –≤—ã—Å–æ—Ç–∞ 8. –ù–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å –±–æ–∫–æ–≤–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (œÄ ‚âà 3.14)', '', False,
             '251.2'],
            [52, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫–æ–Ω—É—Å–µ —Ä–∞–¥–∏—É—Å –æ—Å–Ω–æ–≤–∞–Ω–∏—è 6, –≤—ã—Å–æ—Ç–∞ 8. –ù–∞–π–¥–∏—Ç–µ –æ–±—Ä–∞–∑—É—é—â—É—é', '', False, '10'],
            [53, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –∫–æ–Ω—É—Å–µ —Ä–∞–¥–∏—É—Å –æ—Å–Ω–æ–≤–∞–Ω–∏—è 3, –æ–±—Ä–∞–∑—É—é—â–∞—è 5. –ù–∞–π–¥–∏—Ç–µ –≤—ã—Å–æ—Ç—É', '', False, '4'],
            [54, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í —à–∞—Ä–µ —Ä–∞–¥–∏—É—Å–æ–º 10 –Ω–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º (œÄ ‚âà 3.14)', '', False, '4186.67'],
            [55, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–π –ø–∏—Ä–∞–º–∏–¥–µ —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 6, –≤—ã—Å–æ—Ç–∞ 4. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º', '',
             False, '12‚àö3'],
            [56, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —á–µ—Ç—ã—Ä–µ—Ö—É–≥–æ–ª—å–Ω–æ–π –ø–∏—Ä–∞–º–∏–¥–µ —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 8, –≤—ã—Å–æ—Ç–∞ 3. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º',
             '', False, '64'],
            [57, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —à–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–æ–π –ø—Ä–∏–∑–º–µ —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 2, –≤—ã—Å–æ—Ç–∞ 5. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º', '',
             False, '30‚àö3'],
            [58, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–π –ø—Ä–∏–∑–º–µ —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 4, –≤—ã—Å–æ—Ç–∞ 10. –ù–∞–π–¥–∏—Ç–µ –æ–±—ä–µ–º', '',
             False, '40‚àö3'],
            [59, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í —Å—Ñ–µ—Ä–µ —Ä–∞–¥–∏—É—Å–æ–º 7 –Ω–∞–π–¥–∏—Ç–µ –ø–ª–æ—â–∞–¥—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (œÄ ‚âà 3.14)', '', False, '615.44'],
            [60, '–°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è', '–í —É—Å–µ—á–µ–Ω–Ω–æ–º –∫–æ–Ω—É—Å–µ —Ä–∞–¥–∏—É—Å—ã –æ—Å–Ω–æ–≤–∞–Ω–∏–π 3 –∏ 6, –≤—ã—Å–æ—Ç–∞ 4. –ù–∞–π–¥–∏—Ç–µ –æ–±—Ä–∞–∑—É—é—â—É—é', '', False,
             '5'],

            # –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è (61-70)
            [61, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ sin(45¬∞)', '', False, '‚àö2/2'],
            [62, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ cos(30¬∞)', '', False, '‚àö3/2'],
            [63, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ tg(60¬∞)', '', False, '‚àö3'],
            [64, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: sin¬≤(x) + cos¬≤(x)', '', False, '1'],
            [65, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: 1 + tg¬≤(x)', '', False, '1/cos¬≤(x)'],
            [66, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: sin(œÄ/4) + cos(œÄ/4)', '', False, '‚àö2'],
            [67, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: 2sin(30¬∞)cos(30¬∞)', '', False, '‚àö3/2'],
            [68, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: y = 3 - 2cos(x)', '', False, '1'],
            [69, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: y = 5 + sin(x)', '', False, '6'],
            [70, '–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è', '–ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏: y = cos(3x)', '', False, '2œÄ/3'],

            # –õ–æ–≥–∞—Ä–∏—Ñ–º—ã (71-80)
            [71, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log‚ÇÇ(16)', '', False, '4'],
            [72, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log‚ÇÉ(81)', '', False, '4'],
            [73, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log‚ÇÖ(125)', '', False, '3'],
            [74, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: ln(e‚Åµ)', '', False, '5'],
            [75, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log(10000)', '', False, '4'],
            [76, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: log‚ÇÇ(8) + log‚ÇÇ(4)', '', False, '5'],
            [77, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: log‚ÇÉ(27) - log‚ÇÉ(9)', '', False, '1'],
            [78, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: 2log‚ÇÖ(5) + log‚ÇÖ(25)', '', False, '4'],
            [79, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log‚ÇÑ(2)', '', False, '0.5'],
            [80, '–õ–æ–≥–∞—Ä–∏—Ñ–º—ã', '–ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ: log‚ÇÇ‚Çá(3)', '', False, '1/3'],

            # –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ (81-90)
            [81, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ù–∞–π–¥–∏—Ç–µ 5-–π —á–ª–µ–Ω –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏: 2, 5, 8, ...', '', False, '14'],
            [82, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ù–∞–π–¥–∏—Ç–µ —Å—É–º–º—É –ø–µ—Ä–≤—ã—Ö 10 —á–ª–µ–Ω–æ–≤ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏: 1, 3, 5, ...', '', False,
             '100'],
            [83, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ù–∞–π–¥–∏—Ç–µ 6-–π —á–ª–µ–Ω –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏: 3, 6, 12, ...', '', False, '96'],
            [84, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ù–∞–π–¥–∏—Ç–µ —Å—É–º–º–∞ –ø–µ—Ä–≤—ã—Ö 5 —á–ª–µ–Ω–æ–≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏: 2, 4, 8, ...', '', False,
             '62'],
            [85, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ù–∞–π–¥–∏—Ç–µ —Å—É–º–º—É –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ —É–±—ã–≤–∞—é—â–µ–π –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏: 16, 8, 4, ...', '', False,
             '32'],
            [86, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–†–∞–∑–Ω–æ—Å—Ç—å –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ —Ä–∞–≤–Ω–∞ 3, –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω —Ä–∞–≤–µ–Ω 2. –ù–∞–π–¥–∏—Ç–µ 10-–π —á–ª–µ–Ω', '',
             False, '29'],
            [87, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ —Ä–∞–≤–µ–Ω 2, –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω —Ä–∞–≤–µ–Ω 5. –ù–∞–π–¥–∏—Ç–µ 6-–π —á–ª–µ–Ω',
             '', False, '160'],
            [88, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏',
             '–°—É–º–º–∞ –ø–µ—Ä–≤—ã—Ö 5 —á–ª–µ–Ω–æ–≤ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ —Ä–∞–≤–Ω–∞ 55, –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω —Ä–∞–≤–µ–Ω 5. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–Ω–æ—Å—Ç—å', '',
             False, '3'],
            [89, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏',
             '–°—É–º–º–∞ –ø–µ—Ä–≤—ã—Ö 4 —á–ª–µ–Ω–æ–≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ —Ä–∞–≤–Ω–∞ 30, –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω —Ä–∞–≤–µ–Ω 2. –ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å', '',
             False, '2'],
            [90, '–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏', '–í –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ a‚ÇÅ=3, d=4. –ù–∞–π–¥–∏—Ç–µ —Å—É–º–º—É –ø–µ—Ä–≤—ã—Ö 8 —á–ª–µ–Ω–æ–≤', '', False,
             '136'],

            # –¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (91-100)
            [91, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è –æ—Ä–ª–∞ –ø—Ä–∏ –ø–æ–¥–±—Ä–∞—Å—ã–≤–∞–Ω–∏–∏ –º–æ–Ω–µ—Ç—ã', '', False, '0.5'],
            [92, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è 5 –Ω–∞ –∏–≥—Ä–∞–ª—å–Ω–æ–π –∫–æ—Å—Ç–∏', '', False, '1/6'],
            [93, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è —á–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –Ω–∞ –∏–≥—Ä–∞–ª—å–Ω–æ–π –∫–æ—Å—Ç–∏', '', False, '0.5'],
            [94, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í –∫–æ–ª–æ–¥–µ 36 –∫–∞—Ä—Ç. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã—Ç–∞—â–∏—Ç—å —Ç—É–∑–∞', '', False, '1/9'],
            [95, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–ë—Ä–æ—à–µ–Ω—ã –¥–≤–µ –º–æ–Ω–µ—Ç—ã. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –≤—ã–ø–∞–¥—É—Ç –¥–≤–∞ –æ—Ä–ª–∞', '', False, '0.25'],
            [96, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–ë—Ä–æ—à–µ–Ω—ã –¥–≤–µ –∏–≥—Ä–∞–ª—å–Ω—ã–µ –∫–æ—Å—Ç–∏. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —Å—É–º–º–∞ –æ—á–∫–æ–≤ —Ä–∞–≤–Ω–∞ 8', '', False,
             '5/36'],
            [97, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í —É—Ä–Ω–µ 3 –±–µ–ª—ã—Ö –∏ 7 —á–µ—Ä–Ω—ã—Ö —à–∞—Ä–æ–≤. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã—Ç–∞—â–∏—Ç—å –±–µ–ª—ã–π —à–∞—Ä', '', False,
             '0.3'],
            [98, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –¥–≤—É–∑–Ω–∞—á–Ω–æ–µ —á–∏—Å–ª–æ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 11', '', False,
             '1/10'],
            [99, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π',
             '–í –ª–æ—Ç–µ—Ä–µ–µ 100 –±–∏–ª–µ—Ç–æ–≤, 10 –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö. –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–∏–≥—Ä—ã—à–∞ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞', '', False, '0.1'],
            [100, '–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π', '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –ø—Ä–∏ –¥–≤—É—Ö –±—Ä–æ—Å–∫–∞—Ö –º–æ–Ω–µ—Ç—ã —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –≤—ã–ø–∞–¥–µ—Ç –æ—Ä–µ–ª', '', False,
             '0.75']
        ]

        # –°–æ–∑–¥–∞–µ–º DataFrame –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        self.df = pd.DataFrame(tasks_data, columns=[
            '–Ω–æ–º–µ—Ä', '—Ç–∏–ø_–∑–∞–¥–∞—á–∏', '—Ç–µ–∫—Å—Ç_–∑–∞–¥–∞—á–∏', '–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', '–≤—ã–ø–æ–ª–Ω–µ–Ω–æ', '–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–æ—Ç–≤–µ—Ç'
        ])

        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ '–≤—ã–ø–æ–ª–Ω–µ–Ω–æ' –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø
        self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] = self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'].astype(bool)

    def normalize_ege_answer(self, answer_str):
        """
        –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ï–ì–≠
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: –¥—Ä–æ–±–∏, –∫–æ—Ä–Ω–∏, œÄ, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
        """
        if pd.isna(answer_str):
            return ""

        answer_str = str(answer_str).strip()
        if not answer_str:
            return ""

        # –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ ;
        if ';' in answer_str:
            parts = answer_str.split(';')
            normalized_parts = []
            for part in parts:
                norm_part = self.normalize_single_answer(part.strip())
                if norm_part:
                    normalized_parts.append(norm_part)
            # –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
            try:
                # –ü—Ä–æ–±—É–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ —á–∏—Å–ª–∞
                normalized_parts.sort(key=lambda x: float(x) if self.is_number(x) else x)
            except:
                # –ò–Ω–∞—á–µ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏
                normalized_parts.sort()
            return ';'.join(normalized_parts)

        return self.normalize_single_answer(answer_str)

    def normalize_single_answer(self, answer_str):
        """–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞"""
        answer_str = str(answer_str).strip()

        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        answer_str = re.sub(r'\s+', ' ', answer_str)

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä–æ–±–µ–π: 1/2 ‚Üí 0.5
        if re.match(r'^\d+/\d+$', answer_str):
            try:
                num, denom = map(int, answer_str.split('/'))
                value = num / denom
                if value.is_integer():
                    return str(int(value))
                return str(round(value, 6)).rstrip('0').rstrip('.')
            except:
                pass

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–π: ‚àö2, ‚àö(3)
        if '‚àö' in answer_str:
            try:
                # –ü—Ä–æ—Å—Ç—ã–µ —Å–ª—É—á–∞–∏
                if answer_str == '‚àö2':
                    return str(round(math.sqrt(2), 6)).rstrip('0').rstrip('.')
                elif answer_str == '‚àö3':
                    return str(round(math.sqrt(3), 6)).rstrip('0').rstrip('.')
                elif answer_str == '‚àö2/2':
                    return str(round(math.sqrt(2) / 2, 6)).rstrip('0').rstrip('.')
                elif answer_str == '‚àö3/2':
                    return str(round(math.sqrt(3) / 2, 6)).rstrip('0').rstrip('.')
                # –û–±—â–∏–π —Å–ª—É—á–∞–π ‚àö(—á–∏—Å–ª–æ)
                elif re.match(r'^‚àö\(?(\d+)\)?$', answer_str):
                    num = int(re.search(r'(\d+)', answer_str).group(1))
                    return str(round(math.sqrt(num), 6)).rstrip('0').rstrip('.')
            except:
                pass

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è œÄ
        if 'œÄ' in answer_str:
            try:
                # –ó–∞–º–µ–Ω—è–µ–º œÄ –Ω–∞ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
                expr = answer_str.replace('œÄ', '*3.141592653589793')
                # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ *
                expr = re.sub(r'(\d)(\*)', r'\1', expr)
                value = eval(expr)
                return str(round(value, 6)).rstrip('0').rstrip('.')
            except:
                pass

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ã—á–Ω—ã—Ö —á–∏—Å–µ–ª
        if self.is_number(answer_str):
            try:
                # –ó–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—ã–µ –Ω–∞ —Ç–æ—á–∫–∏
                num_str = answer_str.replace(',', '.')
                value = float(num_str)
                if value.is_integer():
                    return str(int(value))
                return str(round(value, 6)).rstrip('0').rstrip('.')
            except:
                pass

        return answer_str.lower()

    def is_number(self, s):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ —á–∏—Å–ª–æ–º"""
        try:
            s = s.replace(',', '.')
            float(s)
            return True
        except ValueError:
            return False

    def create_main_window(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –≤—ã–±–æ—Ä–æ–º —Ç–∏–ø–∞ –∑–∞–¥–∞—á"""
        # –û—á–∏—â–∞–µ–º –æ–∫–Ω–æ
        for widget in self.root.winfo_children():
            widget.destroy()

        self.root.configure(bg=self.colors['bg'])
        self.root.title("–¢—Ä–µ–Ω–∞–∂–µ—Ä –ï–ì–≠ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_frame = tk.Frame(self.root, bg=self.colors['bg'])
        title_frame.pack(pady=20)

        title_label = tk.Label(title_frame,
                               text="üéØ –¢—Ä–µ–Ω–∞–∂–µ—Ä –ï–ì–≠ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ",
                               font=("Arial", 20, "bold"),
                               bg=self.colors['bg'],
                               fg=self.colors['primary'])
        title_label.pack()

        subtitle_label = tk.Label(title_frame,
                                  text="–ß–∞—Å—Ç—å 1 - –ü—Ä–æ—Ñ–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å",
                                  font=("Arial", 12),
                                  bg=self.colors['bg'],
                                  fg=self.colors['secondary'])
        subtitle_label.pack(pady=5)

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats_frame = tk.Frame(self.root, bg=self.colors['bg'])
        stats_frame.pack(pady=10)

        total_tasks = len(self.df)
        completed_tasks = len(self.df[self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True])
        percentage = (completed_tasks / total_tasks * 100) if total_tasks > 0 else 0

        stats_text = f"üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: {completed_tasks}/{total_tasks} ({percentage:.1f}%)"
        stats_label = tk.Label(stats_frame, text=stats_text,
                               font=("Arial", 14),
                               bg=self.colors['bg'],
                               fg=self.colors['text'])
        stats_label.pack()

        # –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
        progress_frame = tk.Frame(self.root, bg=self.colors['bg'])
        progress_frame.pack(pady=10)

        progress = ttk.Progressbar(progress_frame, length=500,
                                   maximum=100, mode='determinate')
        progress.pack()
        progress['value'] = percentage

        # –ü–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã –∑–∞–¥–∞—á
        task_types = sorted(self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'].unique())

        # –§—Ä–µ–π–º –¥–ª—è –∫–Ω–æ–ø–æ–∫
        buttons_frame = tk.Frame(self.root, bg=self.colors['bg'])
        buttons_frame.pack(pady=20, padx=20, fill='both', expand=True)

        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–µ—Ç–∫—É
        rows = 4
        cols = 3
        for i in range(rows):
            buttons_frame.grid_rowconfigure(i, weight=1)
        for j in range(cols):
            buttons_frame.grid_columnconfigure(j, weight=1)

        # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–¥–∞—á
        buttons = []
        for i, task_type in enumerate(task_types):
            # –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ç–∏–ø—É
            type_tasks = self.df[self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'] == task_type]
            completed_count = len(type_tasks[type_tasks['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True])
            total_count = len(type_tasks)
            type_percentage = (completed_count / total_count * 100) if total_count > 0 else 0

            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏
            if type_percentage == 100:
                bg_color = self.colors['success']
            elif type_percentage >= 50:
                bg_color = '#FFFACD'  # —Å–≤–µ—Ç–ª–æ-–∂–µ–ª—Ç—ã–π
            elif type_percentage > 0:
                bg_color = '#ADD8E6'  # —Å–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π
            else:
                bg_color = self.colors['light']

            btn_text = f"{task_type}\n{completed_count}/{total_count}"
            btn = tk.Button(buttons_frame, text=btn_text,
                            font=("Arial", 11),
                            bg=bg_color,
                            height=3,
                            width=15,
                            command=lambda t=task_type: self.open_task_window(t))

            row = i // cols
            col = i % cols
            btn.grid(row=row, column=col, padx=5, pady=5, sticky='nsew')
            buttons.append(btn)

        # –§—Ä–µ–π–º –¥–ª—è –Ω–∏–∂–Ω–∏—Ö –∫–Ω–æ–ø–æ–∫
        bottom_frame = tk.Frame(self.root, bg=self.colors['bg'])
        bottom_frame.pack(pady=20)

        # –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        stats_btn = tk.Button(bottom_frame, text="üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                              font=("Arial", 10),
                              bg=self.colors['secondary'],
                              fg='white',
                              command=self.show_statistics)
        stats_btn.pack(side='left', padx=5)

        # –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞
        reset_btn = tk.Button(bottom_frame, text="üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ",
                              font=("Arial", 10),
                              bg=self.colors['warning'],
                              command=self.reset_all_tasks)
        reset_btn.pack(side='left', padx=5)

        # –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
        exit_btn = tk.Button(bottom_frame, text="üö™ –í—ã—Ö–æ–¥",
                             font=("Arial", 10),
                             command=self.root.quit)
        exit_btn.pack(side='left', padx=5)

    def open_task_window(self, task_type):
        """–û—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ —Å –∑–∞–¥–∞—á–∞–º–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞"""
        # –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–¥–∞—á–∏ –ø–æ —Ç–∏–ø—É –∏ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º
        tasks = self.df[(self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'] == task_type) &
                        (self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == False)]

        if tasks.empty:
            response = messagebox.askyesno("–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!",
                                           f"–í—Å–µ –∑–∞–¥–∞—á–∏ —Ç–∏–ø–∞ '{task_type}' –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!\n"
                                           "–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —ç—Ç–æ–º—É —Ç–∏–ø—É?")
            if response:
                self.show_type_statistics(task_type)
            return

        # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É
        task = tasks.iloc[0]

        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –æ–∫–Ω–æ
        task_window = tk.Toplevel(self.root)
        task_window.title(f"{task_type} - –ó–∞–¥–∞—á–∞ ‚Ññ{task['–Ω–æ–º–µ—Ä']}")
        task_window.geometry("700x600")
        task_window.configure(bg=self.colors['bg'])

        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª–æ—Å—É –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        main_frame = tk.Frame(task_window, bg=self.colors['bg'])
        main_frame.pack(fill='both', expand=True)

        canvas = tk.Canvas(main_frame, bg=self.colors['bg'])
        scrollbar = ttk.Scrollbar(main_frame, orient="vertical", command=canvas.yview)
        scrollable_frame = tk.Frame(canvas, bg=self.colors['bg'])

        scrollable_frame.bind(
            "<Configure>",
            lambda e: canvas.configure(scrollregion=canvas.bbox("all"))
        )

        canvas.create_window((0, 0), window=scrollable_frame, anchor="nw")
        canvas.configure(yscrollcommand=scrollbar.set)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        header_frame = tk.Frame(scrollable_frame, bg=self.colors['bg'])
        header_frame.pack(fill='x', padx=20, pady=10)

        header = tk.Label(header_frame,
                          text=f"{task_type} - –ó–∞–¥–∞—á–∞ ‚Ññ{task['–Ω–æ–º–µ—Ä']}",
                          font=("Arial", 16, "bold"),
                          bg=self.colors['bg'],
                          fg=self.colors['primary'])
        header.pack()

        # –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–∏–ø—É
        total_type = len(self.df[self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'] == task_type])
        completed_type = total_type - len(tasks) + 1

        progress_label = tk.Label(header_frame,
                                  text=f"–ü—Ä–æ–≥—Ä–µ—Å—Å: {completed_type}/{total_type}",
                                  font=("Arial", 10),
                                  bg=self.colors['bg'],
                                  fg=self.colors['secondary'])
        progress_label.pack()

        # –¢–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏
        text_frame = tk.Frame(scrollable_frame,
                              bg='white',
                              relief='solid',
                              bd=1)
        text_frame.pack(fill='x', padx=20, pady=10)

        task_text = tk.Label(text_frame,
                             text=task['—Ç–µ–∫—Å—Ç_–∑–∞–¥–∞—á–∏'],
                             font=("Arial", 12),
                             wraplength=650,
                             justify='left',
                             bg='white',
                             padx=20,
                             pady=20)
        task_text.pack()

        # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        img_label = None
        img_path = task['–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ']
        if pd.notna(img_path) and img_path and isinstance(img_path, str) and img_path.strip() != '':
            possible_paths = [
                img_path,
                f'images/{img_path}',
                f'images/{os.path.basename(img_path)}'
            ]

            loaded_image = None
            for path in possible_paths:
                if os.path.exists(path):
                    try:
                        img = Image.open(path)
                        img = img.resize((400, 300), Image.Resampling.LANCZOS)
                        loaded_image = ImageTk.PhotoImage(img)
                        break
                    except Exception as e:
                        print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")

            if loaded_image:
                img_frame = tk.Frame(scrollable_frame, bg=self.colors['bg'])
                img_frame.pack(pady=10)
                img_label = tk.Label(img_frame, image=loaded_image)
                img_label.image = loaded_image
                img_label.pack()

        # –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞
        input_frame = tk.Frame(scrollable_frame, bg=self.colors['bg'])
        input_frame.pack(pady=20)

        answer_label = tk.Label(input_frame,
                                text="–í–∞—à –æ—Ç–≤–µ—Ç:",
                                font=("Arial", 12),
                                bg=self.colors['bg'])
        answer_label.pack(side='left')

        answer_var = tk.StringVar()
        answer_entry = tk.Entry(input_frame,
                                textvariable=answer_var,
                                font=("Arial", 12),
                                width=40,
                                bg='white')
        answer_entry.pack(side='left', padx=10)
        answer_entry.focus()

        # –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –æ—Ç–≤–µ—Ç–∞
        hint_label = tk.Label(scrollable_frame,
                              text="–§–æ—Ä–º–∞—Ç: –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ';' (–ø—Ä–∏–º–µ—Ä: 2;3)",
                              font=("Arial", 9),
                              bg=self.colors['bg'],
                              fg='gray')
        hint_label.pack(pady=5)

        # –ö–Ω–æ–ø–∫–∏
        buttons_frame = tk.Frame(scrollable_frame, bg=self.colors['bg'])
        buttons_frame.pack(pady=20)

        submit_btn = tk.Button(buttons_frame,
                               text="‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç",
                               font=("Arial", 12),
                               bg='lightgreen',
                               command=lambda: self.check_answer(
                                   task_window, task['–Ω–æ–º–µ—Ä'],
                                   answer_var.get(), task['–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–æ—Ç–≤–µ—Ç']))
        submit_btn.pack(side='left', padx=5)

        skip_btn = tk.Button(buttons_frame,
                             text="‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å",
                             font=("Arial", 12),
                             bg=self.colors['light'],
                             command=lambda: [task_window.destroy(), self.create_main_window()])
        skip_btn.pack(side='left', padx=5)

        back_btn = tk.Button(buttons_frame,
                             text="üîô –ù–∞–∑–∞–¥",
                             font=("Arial", 12),
                             bg=self.colors['light'],
                             command=lambda: [task_window.destroy(), self.create_main_window()])
        back_btn.pack(side='left', padx=5)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter
        answer_entry.bind('<Return>',
                          lambda e: self.check_answer(
                              task_window, task['–Ω–æ–º–µ—Ä'],
                              answer_var.get(), task['–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–æ—Ç–≤–µ—Ç']))

        # –£–ø–∞–∫–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –∏ –∫–∞–Ω–≤–∞—Å–∞
        canvas.pack(side="left", fill="both", expand=True)
        scrollbar.pack(side="right", fill="y")

    def check_answer(self, window, task_id, user_answer, correct_answer):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user_clean = str(user_answer).strip()
        if not user_clean:
            messagebox.showwarning("–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç", "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç!")
            return

        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –æ–±–∞ –æ—Ç–≤–µ—Ç–∞
        user_norm = self.normalize_ege_answer(user_clean)
        correct_norm = self.normalize_ege_answer(correct_answer)

        # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
        if user_norm == correct_norm:
            # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
            self.df.loc[self.df['–Ω–æ–º–µ—Ä'] == task_id, '–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] = True

            messagebox.showinfo("–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ",
                                f"–í–∞—à –æ—Ç–≤–µ—Ç –≤–µ—Ä–µ–Ω!\n\n"
                                f"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {correct_answer}")
            window.destroy()
            self.create_main_window()
        else:
            # –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
            response = messagebox.askretrycancel("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚ùå",
                                                 f"–û—Ç–≤–µ—Ç '{user_clean}' –Ω–µ–≤–µ—Ä–Ω—ã–π.\n"
                                                 f"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {correct_answer}\n\n"
                                                 "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑?")
            if not response:
                window.destroy()
                self.create_main_window()

    def show_statistics(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"""
        total_tasks = len(self.df)
        completed_tasks = len(self.df[self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True])
        percentage = (completed_tasks / total_tasks * 100) if total_tasks > 0 else 0

        stats_text = f"üìä –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n"
        stats_text += f"‚îú –í—Å–µ–≥–æ –∑–∞–¥–∞—á: {total_tasks}\n"
        stats_text += f"‚îú –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {completed_tasks}\n"
        stats_text += f"‚îú –û—Å—Ç–∞–ª–æ—Å—å: {total_tasks - completed_tasks}\n"
        stats_text += f"‚îî –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {percentage:.1f}%\n\n"

        stats_text += "üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –¢–ò–ü–ê–ú:\n"

        # –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Ç–∏–ø–∞–º
        type_stats = []
        for task_type in sorted(self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'].unique()):
            type_tasks = self.df[self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'] == task_type]
            type_completed = len(type_tasks[type_tasks['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True])
            type_total = len(type_tasks)
            type_percentage = (type_completed / type_total * 100) if type_total > 0 else 0
            type_stats.append((task_type, type_completed, type_total, type_percentage))

        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        type_stats.sort(key=lambda x: x[3], reverse=True)

        for task_type, type_completed, type_total, type_percentage in type_stats:
            # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            bars = 15
            filled = int(bars * type_percentage / 100)
            progress_bar = "‚ñà" * filled + "‚ñë" * (bars - filled)

            stats_text += f"‚îú {task_type:15} {type_completed:3}/{type_total:3} {progress_bar} {type_percentage:5.1f}%\n"

        # –õ—É—á—à–∏–µ –∏ —Ö—É–¥—à–∏–µ —Ç–∏–ø—ã
        if type_stats:
            best_type, best_completed, best_total, best_percent = type_stats[0]
            worst_type, worst_completed, worst_total, worst_percent = type_stats[-1]

            stats_text += f"\nüèÜ –õ—É—á—à–∏–π —Ç–∏–ø: {best_type} ({best_percent:.1f}%)\n"
            stats_text += f"üìâ –•—É–¥—à–∏–π —Ç–∏–ø: {worst_type} ({worst_percent:.1f}%)\n"

        messagebox.showinfo("–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", stats_text)

    def show_type_statistics(self, task_type):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ç–∏–ø—É –∑–∞–¥–∞—á"""
        type_tasks = self.df[self.df['—Ç–∏–ø_–∑–∞–¥–∞—á–∏'] == task_type]
        type_completed = len(type_tasks[type_tasks['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True])
        type_total = len(type_tasks)
        type_percentage = (type_completed / type_total * 100) if type_total > 0 else 0

        stats_text = f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {task_type}\n\n"
        stats_text += f"–í—Å–µ–≥–æ –∑–∞–¥–∞—á: {type_total}\n"
        stats_text += f"–í—ã–ø–æ–ª–Ω–µ–Ω–æ: {type_completed}\n"
        stats_text += f"–ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {type_percentage:.1f}%\n\n"

        # –°–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
        completed = type_tasks[type_tasks['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == True]['–Ω–æ–º–µ—Ä'].tolist()
        if completed:
            stats_text += f"–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏: {', '.join(map(str, completed))}\n\n"

        # –°–ø–∏—Å–æ–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–¥–∞—á
        remaining = type_tasks[type_tasks['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] == False]['–Ω–æ–º–µ—Ä'].tolist()
        if remaining:
            stats_text += f"–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏: {', '.join(map(str, remaining))}"

        messagebox.showinfo(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {task_type}", stats_text)

    def reset_all_tasks(self):
        """–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á"""
        if messagebox.askyesno("–°–±—Ä–æ—Å –≤—Å–µ—Ö –∑–∞–¥–∞—á",
                               "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –í–°–ï–• –∑–∞–¥–∞—á?\n\n"
                               "–í—Å–µ –∑–∞–¥–∞—á–∏ –±—É–¥—É—Ç –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ.\n"
                               "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!"):
            # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            self.df['–≤—ã–ø–æ–ª–Ω–µ–Ω–æ'] = False
            self.create_main_window()
            messagebox.showinfo("–°–±—Ä–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω", "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á —Å–±—Ä–æ—à–µ–Ω–æ!")


def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É"""
    root = tk.Tk()

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É (–µ—Å–ª–∏ –µ—Å—Ç—å)
    try:
        root.iconbitmap('icon.ico')
    except:
        pass

    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    app = TaskApp(root)

    # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ
    root.update_idletasks()
    width = root.winfo_width()
    height = root.winfo_height()
    x = (root.winfo_screenwidth() // 2) - (width // 2)
    y = (root.winfo_screenheight() // 2) - (height // 2)
    root.geometry(f'{width}x{height}+{x}+{y}')

    # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª
    root.mainloop()


if __name__ == "__main__":
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
    try:
        import pandas as pd
        from PIL import Image, ImageTk

        print("–í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
        print(f"–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —Å {len(TaskApp.__init__.__code__.co_consts)} –∑–∞–¥–∞—á")
        main()
    except ImportError as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
        print("\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:")
        print("pip install pandas pillow")
        input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
